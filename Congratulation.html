<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>4Site Auto-Experience</title>
<style>
  /* Your existing CSS styles remain unchanged */
</style>
</head>
<body>

<!-- Your existing HTML structure -->

<audio id="gongAudio"></audio>

<script>
// First: Create and initialize the audio context immediately
let audioContext;
try {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
} catch(e) {
    console.log("Web Audio API not supported");
}

// Second: Preload the audio file asynchronously
let audioBuffer;
fetch('Gong.mp3')
    .then(response => response.arrayBuffer())
    .then(arrayBuffer => {
        if(audioContext) {
            return audioContext.decodeAudioData(arrayBuffer);
        }
        return null;
    })
    .then(buffer => {
        audioBuffer = buffer;
        console.log("Audio preloaded successfully");
    })
    .catch(e => console.error("Audio preload failed:", e));

// Third: Start the experience with automatic audio
function startExperience() {
    // Your existing animation code
    doorContainer.classList.add('open');
    
    setTimeout(() => {
        // Try to play audio through Web Audio API first
        if(audioBuffer && audioContext) {
            const source = audioContext.createBufferSource();
            source.buffer = audioBuffer;
            source.connect(audioContext.destination);
            
            // Some browsers require this resume() call
            audioContext.resume().then(() => {
                source.start(0);
                console.log("Web Audio playback started");
            });
        } 
        // Fallback to HTML5 Audio if Web Audio fails
        else {
            const audio = document.getElementById('gongAudio');
            audio.src = 'Gong.mp3';
            audio.volume = 0.8;
            
            // Create a silent video element to trick browsers
            const video = document.createElement('video');
            video.muted = true;
            video.src = 'Gong.mp3';
            video.play().then(() => {
                // Now try playing the actual audio
                setTimeout(() => {
                    audio.play().catch(e => {
                        console.log("Final fallback failed, user interaction required");
                    });
                }, 300);
            });
        }
        
        // Continue with your animations
        setTimeout(() => {
            doorContainer.style.display = 'none';
            celebrate.style.display = 'flex';
            launchConfetti();
        }, 1800);
    }, 1000);
}

// Fourth: Start everything after a small delay
setTimeout(() => {
    // This invisible interaction helps some browsers
    const invisibleButton = document.createElement('button');
    invisibleButton.style.position = 'fixed';
    invisibleButton.style.opacity = '0';
    invisibleButton.style.pointerEvents = 'none';
    document.body.appendChild(invisibleButton);
    invisibleButton.click();
    
    // Begin the experience
    startExperience();
    
    // Clean up
    setTimeout(() => invisibleButton.remove(), 2000);
}, 500);
</script>
</body>
</html>
